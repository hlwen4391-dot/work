# è¡€æ¡ç³»ç»Ÿå¿«é€ŸæŒ‡å—

## ğŸ¯ å·²å®Œæˆçš„ä¿®æ”¹

### 1. StatsComponent (ç»Ÿè®¡ç»„ä»¶)
âœ… æ·»åŠ äº† `maxHp` å±æ€§ - å­˜å‚¨æœ€å¤§ç”Ÿå‘½å€¼
âœ… æ·»åŠ äº† `updateHealthBar(damage)` æ–¹æ³• - æ›´æ–°è¡€æ¡æ˜¾ç¤º

### 2. CombatSystem (æˆ˜æ–—ç³»ç»Ÿ)
âœ… `damage()` æ–¹æ³• - æ™®é€šä¼¤å®³åè‡ªåŠ¨æ›´æ–°è¡€æ¡
âœ… `damageTrue()` æ–¹æ³• - çœŸå®ä¼¤å®³åè‡ªåŠ¨æ›´æ–°è¡€æ¡

### 3. BuffRegistry (Buffæ•°æ®åº“)
âœ… `burn` buff - ç‡ƒçƒ§ä¼¤å®³åè‡ªåŠ¨æ›´æ–°è¡€æ¡

### 4. BattleController (æˆ˜æ–—æ§åˆ¶å™¨)
âœ… `initEntity()` - åˆå§‹åŒ–æ—¶è®¾ç½® maxHp å’Œåˆå§‹è¡€æ¡æ˜¾ç¤º

### 5. HealthBar (è¡€æ¡ç»„ä»¶)
âœ… æ”¯æŒ `ProgressBar` å’Œ `Sprite` ä¸¤ç§æ˜¾ç¤ºæ–¹å¼
âœ… `updateHealth()` - æ›´æ–°è¡€æ¡è¿›åº¦
âœ… `showDamage()` - æ˜¾ç¤ºä¼¤å®³æ•°å­—(å¸¦å‘ä¸Šé£˜åŠ¨ç”»)

## ğŸ® åœ¨ç¼–è¾‘å™¨ä¸­è®¾ç½®(3æ­¥å®Œæˆ)

### ç¬¬1æ­¥:åˆ›å»ºè¡€æ¡UI

åœ¨ `Hero.prefab` å’Œ `Monster.prefab` ä¸­:

1. åˆ›å»ºå­èŠ‚ç‚¹ "HealthBar"
2. åœ¨ HealthBar ä¸‹æ·»åŠ  UI ç»„ä»¶:
   - **æ–¹å¼A(æ¨è)**: æ·»åŠ  `ProgressBar` ç»„ä»¶
   - **æ–¹å¼B**: æ·»åŠ ä¸¤ä¸ª `Sprite` (èƒŒæ™¯ + å¡«å……)
3. æ·»åŠ  `Label` èŠ‚ç‚¹ç”¨äºæ˜¾ç¤ºä¼¤å®³æ•°å­—

### ç¬¬2æ­¥:æ·»åŠ HealthBarè„šæœ¬

1. åœ¨ HealthBar èŠ‚ç‚¹æ·»åŠ  `HealthBar.js` ç»„ä»¶
2. æ‹–æ‹½å¼•ç”¨:
   - `Health Progress` â† ProgressBarç»„ä»¶(æ–¹å¼A)
   - `Health Fill` â† å¡«å……Sprite(æ–¹å¼B)
   - `Damage Label` â† Labelç»„ä»¶

### ç¬¬3æ­¥:ç¡®ä¿ç»„ä»¶å®Œæ•´

ç¡®ä¿é¢„åˆ¶ä½“æ ¹èŠ‚ç‚¹æœ‰è¿™äº›ç»„ä»¶:
- âœ… StatsComponent
- âœ… TeamComponent
- âœ… SkillComponent
- âœ… CombatComponent
- âœ… AttackMover (å¯é€‰)

## ğŸ”„ å·¥ä½œæµç¨‹

```
æˆ˜æ–—å¼€å§‹
  â†“
BattleController.initEntity()
  â†’ è®¾ç½® maxHp = hp
  â†’ è°ƒç”¨ stats.updateHealthBar()
  â†’ åˆå§‹åŒ–è¡€æ¡ä¸ºæ»¡è¡€çŠ¶æ€

å•ä½å—åˆ°ä¼¤å®³
  â†“
CombatSystem.damage() / damageTrue()
  â†’ è®¡ç®—æœ€ç»ˆä¼¤å®³
  â†’ stats.hp -= damage
  â†’ è‡ªåŠ¨è°ƒç”¨ stats.updateHealthBar(damage)
  
BuffæŒç»­ä¼¤å®³(å¦‚ç‡ƒçƒ§)
  â†“
BuffRegistry.burn.onTick()
  â†’ stats.hp -= damage
  â†’ è‡ªåŠ¨è°ƒç”¨ stats.updateHealthBar(damage)

HealthBarç»„ä»¶
  â†“
updateHealth(hp, maxHp)
  â†’ æ›´æ–° ProgressBar.progress = hp/maxHp
  
showDamage(value)
  â†’ æ˜¾ç¤º "-XX" ä¼¤å®³æ•°å­—
  â†’ cc.tween å‘ä¸Šé£˜ + æ·¡å‡ºåŠ¨ç”»
```

## ğŸ“‹ æ£€æŸ¥æ¸…å•

åœ¨è¿è¡Œæ¸¸æˆå‰,è¯·ç¡®ä¿:

- [ ] Hero.prefab å’Œ Monster.prefab éƒ½æœ‰ HealthBar å­èŠ‚ç‚¹
- [ ] HealthBar èŠ‚ç‚¹æœ‰ HealthBar è„šæœ¬ç»„ä»¶
- [ ] HealthBar è„šæœ¬çš„å±æ€§éƒ½å·²æ­£ç¡®å¼•ç”¨
- [ ] é¢„åˆ¶ä½“æ ¹èŠ‚ç‚¹æœ‰ StatsComponent ç»„ä»¶
- [ ] StatsComponent çš„ hp å’Œ maxHp å·²è®¾ç½®

## ğŸ¨ å¯è§†åŒ–æ•ˆæœ

å½“ç³»ç»Ÿæ­£å¸¸å·¥ä½œæ—¶,ä½ ä¼šçœ‹åˆ°:

1. **è¡€æ¡**
   - ç»¿è‰²/çº¢è‰²è¿›åº¦æ¡
   - éšHPå®æ—¶æ›´æ–°
   - 0-100%èŒƒå›´

2. **ä¼¤å®³æ•°å­—**
   - çº¢è‰² "-XX" æ–‡å­—
   - ä»è¡€æ¡ä½ç½®å‘ä¸Šé£˜åŠ¨
   - åŒæ—¶é€æ˜åº¦ä»255â†’0
   - 1ç§’åæ¶ˆå¤±

## ğŸ› å¸¸è§é—®é¢˜

**Q: è¡€æ¡ä¸æ˜¾ç¤º?**
A: æ£€æŸ¥ HealthBar èŠ‚ç‚¹æ˜¯å¦æ¿€æ´»,ProgressBarå¼•ç”¨æ˜¯å¦æ­£ç¡®

**Q: è¡€æ¡ä¸æ›´æ–°?**
A: åœ¨ `StatsComponent.onLoad()` ä¸­æ·»åŠ æ—¥å¿—,ç¡®è®¤æ‰¾åˆ°äº† HealthBar ç»„ä»¶

**Q: ä¼¤å®³æ•°å­—ä¸æ˜¾ç¤º?**
A: æ£€æŸ¥ DamageLabel å¼•ç”¨,ç¡®è®¤ Label èŠ‚ç‚¹çš„ opacity = 255

**Q: ä¼¤å®³æ•°å­—ä½ç½®ä¸å¯¹?**
A: è°ƒæ•´ DamageLabel èŠ‚ç‚¹çš„åˆå§‹ä½ç½®(ç›¸å¯¹äºHealthBar)

## ğŸ’¡ æ‰©å±•å»ºè®®

å¦‚æœä½ æƒ³è¦æ›´ç‚«é…·çš„æ•ˆæœ,å¯ä»¥:

- è¡€æ¡é¢œè‰²éšè¡€é‡å˜åŒ–(ç»¿â†’é»„â†’çº¢)
- è¡€æ¡ç¼“åŠ¨è¿‡æ¸¡(ä¸æ˜¯ç«‹å³å˜åŒ–)
- æš´å‡»ä¼¤å®³æ˜¾ç¤ºä¸ºæ›´å¤§çš„å­—ä½“
- æ²»ç–—æ•ˆæœæ˜¾ç¤ºä¸ºç»¿è‰²"+XX"
- æ·»åŠ æŠ¤ç›¾æ¡(è“è‰²)åœ¨è¡€æ¡ä¸Šæ–¹

